# JSON bodies are able to be parsed but JSON paramaters are not able to be parsed, they trigger a bunch of rules and trigger a TX:MSC_PCRE_LIMITS_EXCEEDED regex recursion limit error.
# Increasing this limit bogs down the system so just excluding paths that use json parameters.
# https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/46

# --------------------------------- AssetMaster API -------------------------------------------------------------------
<LocationMatch /assetmaster/(assetAPI|assetCreationAPI|assetSearchAPI)/.*> 
	SecRuleRemoveById 200004 # TX:MSC_PCRE_LIMITS_EXCEEDED regex recursion limit error for all of the AM assetAPI
	SecRuleRemoveById 960024
	SecRuleRemoveById 981173
	SecRuleRemoveById 981257
	SecRuleRemoveById 981245
	SecRuleRemoveById 981242
	SecRuleRemoveById 981246
	SecRuleRemoveById 981243
	SecRuleRemoveById 973335
	SecRuleRemoveById 960009
	SecRuleRemoveById 960015
</LocationMatch>
# --------------------------------- AssetMaster API -------------------------------------------------------------------

# --------------------------------- FileFort API -------------------------------------------------------------------
<LocationMatch /filefort/(assetAPI|assetSearchAPI|assetFileAPI)/.*> 
	SecRuleRemoveById 200004 # TX:MSC_PCRE_LIMITS_EXCEEDED regex recursion limit error for all of the AM assetAPI
	SecRuleRemoveById 960024
	SecRuleRemoveById 981173
	SecRuleRemoveById 981257
	SecRuleRemoveById 981245
	SecRuleRemoveById 981242
	SecRuleRemoveById 981246
	SecRuleRemoveById 981243
	SecRuleRemoveById 973335
	SecRuleRemoveById 960009
	SecRuleRemoveById 960015
</LocationMatch>
# --------------------------------- AssetMaster API -------------------------------------------------------------------

# --------------------------------- UsersMaster API -------------------------------------------------------------------
<LocationMatch /usersmaster/usersAPI/(getUser|createOrUpdate|getUserByExternalId)> 
	SecRuleRemoveById 200004 # TX:MSC_PCRE_LIMITS_EXCEEDED regex recursion limit error for all of the AM assetAPI
	SecRuleRemoveById 960024
	SecRuleRemoveById 981173
	SecRuleRemoveById 981257
	SecRuleRemoveById 981245
	SecRuleRemoveById 981242
	SecRuleRemoveById 981246
	SecRuleRemoveById 981243
	SecRuleRemoveById 973335
	SecRuleRemoveById 960009
	SecRuleRemoveById 960015
</LocationMatch>
# --------------------------------- UsersMaster API -------------------------------------------------------------------

# --------------------------------- ProjectManager API -------------------------------------------------------------------
<LocationMatch /projectmanager/projectAPI/(getProjects|createOrUpdate|delete|addLogMessage)> # TX:MSC_PCRE_LIMITS_EXCEEDED regex recursion limit error 
	SecRuleRemoveById 200004 # TX:MSC_PCRE_LIMITS_EXCEEDED regex recursion limit error for all of the AM assetAPI
	SecRuleRemoveById 960024
	SecRuleRemoveById 981173
	SecRuleRemoveById 981257
	SecRuleRemoveById 981245
	SecRuleRemoveById 981242
	SecRuleRemoveById 981246
	SecRuleRemoveById 981243
	SecRuleRemoveById 973335
	SecRuleRemoveById 960009
	SecRuleRemoveById 960015
</LocationMatch>
# --------------------------------- ProjectManager API -------------------------------------------------------------------

# --------------------------------- SPIDADB API --------------------------------------------------------------------------
<LocationMatch /spidadb(/v[0-9]+)?/(projects|locations|desgins)(.*)> 
	SecRuleRemoveById 200004 # TX:MSC_PCRE_LIMITS_EXCEEDED regex recursion limit error 
	SecRuleRemoveById 960024
	SecRuleRemoveById 981173
	SecRuleRemoveById 981257
	SecRuleRemoveById 981245
	SecRuleRemoveById 981242
	SecRuleRemoveById 981246
	SecRuleRemoveById 981243
	SecRuleRemoveById 973335
	SecRuleRemoveById 981231
	SecRuleRemoveById 981240
	SecRuleRemoveById 960009
	SecRuleRemoveById 960015
	SecRuleRemoveById 959071
	SecRuleRemoveById 950901
	SecRuleRemoveById 960915
	SecRuleRemoveById 959073
</LocationMatch>

# --------------------------------- Webhooks Tool --------------------------------------------------------------------------
<LocationMatch /webhooks/.*> 
	SecRuleRemoveById 200004 # TX:MSC_PCRE_LIMITS_EXCEEDED regex recursion limit error 
	SecRuleRemoveById 960024
	SecRuleRemoveById 981173
	SecRuleRemoveById 981257
	SecRuleRemoveById 981245
	SecRuleRemoveById 981242
	SecRuleRemoveById 981246
	SecRuleRemoveById 981243
	SecRuleRemoveById 973335
	SecRuleRemoveById 981231
	SecRuleRemoveById 981240
	SecRuleRemoveById 960009
	SecRuleRemoveById 960015
	SecRuleRemoveById 959071
	SecRuleRemoveById 950901
	SecRuleRemoveById 960915
	SecRuleRemoveById 959073
</LocationMatch>

# Allow http DELETE method
# id 960032  is fired in phase 1 LocationMatch rules work only for phase 2 rules.
SecRule REQUEST_URI "/spidadb(/v[0-9]+)?/(projects|locations|desgins)(.*)" "id:'1000',phase:1,t:none,pass,nolog,ctl:ruleRemoveById=960032"

SecRuleRemoveByID 960032
# --------------------------------- SPIDADB API --------------------------------------------------------------------------

# --------------------------------- UI json paramaters --------------------------------------------------------------------
# ARCGis Configuration
SecRule REQUEST_URI "/projectmanager/arcGISConfiguration/(save|update)" "id:'2700',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=960024;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/arcGISConfiguration/(save|update)" "id:'2701',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/arcGISConfiguration/(save|update)" "id:'2702',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981257;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/arcGISConfiguration/(save|update)" "id:'2703',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981245;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/arcGISConfiguration/(save|update)" "id:'2704',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981242;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/arcGISConfiguration/(save|update)" "id:'2705',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981246;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/arcGISConfiguration/(save|update)" "id:'2706',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981243;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/arcGISConfiguration/(save|update)" "id:'2707',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=973335;ARGS:gisJSON" 
<LocationMatch /projectmanager/arcGISConfiguration/(save|update)> # TX:MSC_PCRE_LIMITS_EXCEEDED regex recursion limit error 
	SecRuleRemoveById 200004 
</LocationMatch>

# WFS Configuration
SecRule REQUEST_URI "/projectmanager/wfsConfiguration/(save|update)" "id:'2800',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=960024;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/wfsConfiguration/(save|update)" "id:'2801',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/wfsConfiguration/(save|update)" "id:'2802',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981257;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/wfsConfiguration/(save|update)" "id:'2803',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981245;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/wfsConfiguration/(save|update)" "id:'2804',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981242;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/wfsConfiguration/(save|update)" "id:'2805',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981246;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/wfsConfiguration/(save|update)" "id:'2806',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981243;ARGS:gisJSON"
SecRule REQUEST_URI "/projectmanager/wfsConfiguration/(save|update)" "id:'2807',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=973335;ARGS:gisJSON" 
<LocationMatch /projectmanager/wfsConfiguration/(save|update)> # TX:MSC_PCRE_LIMITS_EXCEEDED regex recursion limit error 
	SecRuleRemoveById 200004
</LocationMatch>

# Email Configuration
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster)/emailConfiguration/(save|update)" "id:'2900',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=960024;ARGS:emailProperties"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster)/emailConfiguration/(save|update)" "id:'2901',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:emailProperties"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster)/emailConfiguration/(save|update)" "id:'2902',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981257;ARGS:emailProperties"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster)/emailConfiguration/(save|update)" "id:'2903',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981245;ARGS:emailProperties"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster)/emailConfiguration/(save|update)" "id:'2904',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981242;ARGS:emailProperties"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster)/emailConfiguration/(save|update)" "id:'2905',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981246;ARGS:emailProperties"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster)/emailConfiguration/(save|update)" "id:'2906',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981243;ARGS:emailProperties"
<LocationMatch /(assetmaster|spidadb|licensemanager|projectmanager|usersmaster)/emailConfiguration/(save|update)> # TX:MSC_PCRE_LIMITS_EXCEEDED regex recursion limit error 
	SecRuleRemoveById 200004
</LocationMatch>

# Map Layer Config
<LocationMatch /projectmanager/mapLayer/(save|update)>
    SecRuleRemoveById 950120
    SecRuleRemoveById 981173
    SecRuleRemoveById 981257
    SecRuleRemoveById 973335
    SecRuleRemoveById 973334
</LocationMatch>
<LocationMatch /projectmanager/mapLayer/identify/.*>
    SecRuleRemoveById 981173
</LocationMatch>
<LocationMatch /projectmanager/map/getMapLayerShowValues>
    SecRuleRemoveById 981173
    SecRuleRemoveById 981257
</LocationMatch>

# --------------------------------- UI json paramaters --------------------------------------------------------------------

# --------------------------------- UI paramaters -------------------------------------------------------------------------
# UI long list of stations errors
SecRule REQUEST_URI "/projectmanager/selection/(saveNewProject|addToProject|createTag|removeFromTag|addToTag|removeFromProject|removeFromSelectedTags)" "id:'3000',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:items"
SecRule REQUEST_URI "/projectmanager/selection/(saveNewProject|addToProject|createTag|removeFromTag|addToTag|removeFromProject|removeFromSelectedTags)" "id:'3001',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981257;ARGS:items"
<LocationMatch /projectmanager/selection/(saveNewProject|addToProject|createTag|removeFromTag|addToTag|removeFromProject|removeFromSelectedTags)> # TX:MSC_PCRE_LIMITS_EXCEEDED regex recursion limit error 
	SecRuleRemoveById 200004
	SecRuleRemoveById 960335
</LocationMatch>

SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3030',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:codes"
SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3031',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981257;ARGS:codes"
SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3032',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981245;ARGS:codes"
SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3033',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981246;ARGS:codes"
SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3034',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981243;ARGS:codes"

SecRule REQUEST_URI "/projectmanager/dataForm/confirmDialog" "id:'3040',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950901;ARGS:message"
SecRule REQUEST_URI "/projectmanager/dataForm/confirmDialog" "id:'3041',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:message"
SecRule REQUEST_URI "/projectmanager/dataForm/confirmDialog" "id:'3042',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=973300;ARGS:message"

# Login exceptions
SecRule REQUEST_URI "/cas/login" "id:'3050',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:lt"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster|monitor|filefort)/j_spring_cas_security_check" "id:'3051',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:ticket"
SecRule REQUEST_URI "/cas/serviceValidate" "id:'3052',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:ticket"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster|monitor|filefort)/secure/receptor" "id:'3053',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:pgtIou"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster|monitor|filefort)/secure/receptor" "id:'3054',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:pgtId"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster|monitor|filefort)/j_spring_cas_security_check" "id:'3055',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950901;ARGS:logoutRequest"
SecRule REQUEST_URI "/geoserver(/web)?" "id:'3056',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950901;ARGS:logoutRequest"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster|monitor|filefort)/j_spring_cas_security_check" "id:'3057',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:logoutRequest"
SecRule REQUEST_URI "/geoserver/(/web)?" "id:'3058',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:logoutRequest"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster|monitor|filefort)/j_spring_cas_security_check" "id:'3059',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981245;ARGS:logoutRequest"
SecRule REQUEST_URI "/geoserver(/web)?" "id:'3060',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981245;ARGS:logoutRequest"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster|monitor|filefort)/j_spring_cas_security_check" "id:'3061',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981243;ARGS:logoutRequest"
SecRule REQUEST_URI "/geoserver(/web)?" "id:'3062',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981243;ARGS:logoutRequest"
SecRule REQUEST_URI "/geoserver(/web)?" "id:'3064',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=973338;ARGS:logoutRequest"
SecRule REQUEST_URI "/(assetmaster|spidadb|licensemanager|projectmanager|usersmaster|monitor|filefort)/j_spring_cas_security_check" "id:'3065',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=973332;ARGS:logoutRequest"
SecRule REQUEST_URI "/geoserver(/web)?" "id:'3066',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=973332;ARGS:logoutRequest"

<LocationMatch /cas/login>
	SecRuleRemoveById 981318
</LocationMatch>
<LocationMatch /cas/logout>
	SecRuleRemoveById 981318
</LocationMatch>
<LocationMatch /cas/serviceValidate>
	SecRuleRemoveById 981318
	SecRuleRemoveById 973338
</LocationMatch>
<LocationMatch /(assetmaster|spidadb|licensemanager|projectmanager|usersmaster|monitor|filefort)/j_spring_cas_security_check>
	SecRuleRemoveById 973338
</LocationMatch>

#This is needed for > 16.x
<LocationMatch /projectmanager/mediaItem/upload>
    SecRuleRemoveById 960915
    SecRuleRemoveById 200003
</LocationMatch>

#This is needed for 15.1
<LocationMatch /projectmanager/mediaItem/save>
    SecRuleRemoveById 960915
    SecRuleRemoveById 200003
</LocationMatch>

# Dashboard cookie
SecRule REQUEST_URI "/projectmanager" "id:'3067',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=960017;REQUEST_COOKIES:json"
SecRule REQUEST_URI "/projectmanager" "id:'3068',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981172;REQUEST_COOKIES:json"
SecRule REQUEST_URI "/projectmanager" "id:'3069',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981257;REQUEST_COOKIES:json"
SecRule REQUEST_URI "/projectmanager" "id:'3070',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981245;REQUEST_COOKIES:json"
SecRule REQUEST_URI "/projectmanager" "id:'3071',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981246;REQUEST_COOKIES:json"
SecRule REQUEST_URI "/projectmanager" "id:'3072',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981243;REQUEST_COOKIES:json"

# --------------------------------- UI paramaters -------------------------------------------------------------------------

# --------------------------------- Passwords -----------------------------------------------------------------------------
# I was using a randomly generated password: 1ImqJmA0%w@h and this rule was triggering
# So ignore the password paramater for this rule, tried to find everywhere we have password parametes
# cas login, um changing password, um profile edit password, um user update, um user save, geoserver login, geoserver change password
SecRule REQUEST_URI "@beginsWith /cas/login" "id:'3100',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950109;ARGS:password"
SecRule REQUEST_URI "@beginsWith /usersmaster/password/index" "id:'3101',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950109;ARGS:password,ctl:ruleRemoveTargetById=950109;ARGS:passwordConfirm"
SecRule REQUEST_URI "@beginsWith /usersmaster/profile/updatePassword" "id:'3102',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950109;ARGS:password,ctl:ruleRemoveTargetById=950109;ARGS:confirm."
SecRule REQUEST_URI "@beginsWith /usersmaster/user/index" "id:'3103',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950109;ARGS:password,ctl:ruleRemoveTargetById=950109;ARGS:passwordConfirm"
SecRule REQUEST_URI "@beginsWith /usersmaster/user/save" "id:'3104',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950109;ARGS:password,ctl:ruleRemoveTargetById=950109;ARGS:passwordConfirm"
SecRule REQUEST_URI "@beginsWith /geoserver/j_spring_security_check" "id:'3105',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950109;ARGS:password"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3106',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950109;ARGS:password,ctl:ruleRemoveTargetById=950109;ARGS:confirmPassword,ctl:ruleRemoveTargetById=950109;ARGS:newPassword,ctl:ruleRemoveTargetById=950109;ARGS:newPasswordConfirm"
# --------------------------------- Passwords -----------------------------------------------------------------------------

# --------------------------------- Geoserver -----------------------------------------------------------------------------  
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3200',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=973338;ARGS:workspacePanel:border:paramValue"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3201',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=960024;ARGS:wicket:interface"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3202',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=973338;ARGS:wicket:bookmarkablePage"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3203',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=973338;ARGS:wicket:bookmarkablePage"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3204',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950120;ARGS:uri"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3205',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950120;ARGS:onlineResource"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3206',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=950120;ARGS:maintainer"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3207',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981231;ARGS:workspacePanel:border:paramValue"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3209',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981277;ARGS:anim.maxallowedframes"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3210',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=960024;ARGS:abstract"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3211',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=959072;ARGS:abstract" 
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3212',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=973338;ARGS:navigatorAppVersion"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3213',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981231;ARGS:patternString"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3214',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=960024;ARGS:patternString"
SecRule REQUEST_URI "@beginsWith /geoserver/web" "id:'3215',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981231;ARGS:patternString"
<LocationMatch /geoserver/web>
     SecRuleRemoveById 981173
</LocationMatch>
# --------------------------------- Geoserver -----------------------------------------------------------------------------

# --------------------------------- Atmosphere ----------------------------------------------------------------------------
# Allow atmosphere websockets
# Atmosphere does not send an Accept Header and owasp rules 960010 and 960015 block this
# Tried adding an Accept header to the atmosphere request but the atmosphere framework doesn't allow adding headers to websocket requests.
# Check if path is the atmosphere path
<LocationMatch /(assetmaster|spidadb|licensemanager|projectmanager|usersmaster|monitor)/atmosphere/messages/[0-9]+?(.*)>
     SecRuleRemoveById 960010
     SecRuleRemoveById 960015
     SecRuleRemoveById 970901
     SecRuleRemoveById 981205
</LocationMatch>
# --------------------------------- Atmosphere ----------------------------------------------------------------------------

# ---------------------------------- Ember REST Service -------------------------------------------------------------------
<LocationMatch /projectmanager/rest/.*>
     SecRuleRemoveById 960024
     SecRuleRemoveById 973335
     SecRuleRemoveById 981173
     SecRuleRemoveById 981231
     SecRuleRemoveById 981240
     SecRuleRemoveById 981242
     SecRuleRemoveById 981243
     SecRuleRemoveById 981245
     SecRuleRemoveById 981246
     SecRuleRemoveById 981257
</LocationMatch>

# ---------------------------------- Flow properties and layout updates -------------------------------------------------------------------
SecRule REQUEST_URI "/projectmanager/flow/update" "id:'3310',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetByTag=.*;ARGS:flowLayoutJson"
SecRule REQUEST_URI "/projectmanager/flow/update" "id:'3311',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=960024;ARGS:flowLayoutJson"


# ---------------------------------- Allow special chars in project names -------------------------------------------------------------------
SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3400',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=960024;ARGS:codes"
SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3401',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981173;ARGS:codes"
SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3402',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981257;ARGS:codes"
SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3403',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981245;ARGS:codes"
SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3404',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981242;ARGS:codes"
SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3405',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981246;ARGS:codes"
SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3406',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981243;ARGS:codes"
SecRule REQUEST_URI "/projectmanager/project/validateProjectCodes" "id:'3407',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=973335;ARGS:codes"

# ---------------------------------- Allow special chars in form template names -------------------------------------------------------------------
<LocationMatch /projectmanager/formTemplate/.*>
     SecRuleRemoveById 960024
     SecRuleRemoveById 973335
     SecRuleRemoveById 981173
     SecRuleRemoveById 981231
     SecRuleRemoveById 981240
     SecRuleRemoveById 981242
     SecRuleRemoveById 981243
     SecRuleRemoveById 981245
     SecRuleRemoveById 981246
     SecRuleRemoveById 981257
</LocationMatch>

<LocationMatch /projectmanager/project/update>
	SecRuleRemoveById 960024
	SecRuleRemoveById 981173
	SecRuleRemoveById 981257
	SecRuleRemoveById 981245
	SecRuleRemoveById 981242
	SecRuleRemoveById 981246
	SecRuleRemoveById 981243
	SecRuleRemoveById 973335
</LocationMatch>

# ---------------------------------- Allow Webhooks login token -------------------------------------------------------------------
SecRule REQUEST_URI "/" "id:'3410',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=960017;REQUEST_COOKIES:LOGIN_TOKEN"
SecRule REQUEST_URI "/" "id:'3411',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981172;REQUEST_COOKIES:LOGIN_TOKEN"
SecRule REQUEST_URI "/" "id:'3412',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981257;REQUEST_COOKIES:LOGIN_TOKEN"
SecRule REQUEST_URI "/" "id:'3413',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981245;REQUEST_COOKIES:LOGIN_TOKEN"
SecRule REQUEST_URI "/" "id:'3414',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981246;REQUEST_COOKIES:LOGIN_TOKEN"
SecRule REQUEST_URI "/" "id:'3415',phase:1,t:none,pass,nolog,ctl:ruleRemoveTargetById=981243;REQUEST_COOKIES:LOGIN_TOKEN"
